# =============================================================================
# Clipset Configuration
# =============================================================================
# Copy this file to .env and customize for your deployment
# Generate SECRET_KEY: openssl rand -hex 32

# =============================================================================
# DATABASE
# =============================================================================
# Docker: Use /data/clipset.db (mapped to ./data on host)
# Local dev: Use relative path like ../data/clipset.db
DATABASE_URL=sqlite+aiosqlite:////data/clipset.db

# =============================================================================
# SECURITY
# =============================================================================
# IMPORTANT: Generate a random secret key for production!
# Run: openssl rand -hex 32
SECRET_KEY=change-me-to-a-random-secret-key-min-32-chars

ALGORITHM=HS256

# Token expiration (in minutes)
# Default: 43200 = 30 days
ACCESS_TOKEN_EXPIRE_MINUTES=43200

# HLS Signing Secret for nginx secure_link validation
# Used to sign HLS segment URLs for direct nginx serving (bypasses Python)
# If not set, automatically derived from SECRET_KEY
# Generate: openssl rand -hex 16
# IMPORTANT: Must match the value in nginx config
HLS_SIGNING_SECRET=

# =============================================================================
# STORAGE PATHS
# =============================================================================
# Docker: All paths must be under /data/
# Example: /data/uploads/videos, /data/external/nas/videos
# 
# External drives: Mount to ./data/external on host machine
# Example: sudo mount --bind /mnt/your-drive ./data/external
# Then use: /data/external/videos
#
# WARNING: Changing these paths in admin panel will NOT move existing files.
# You must manually migrate data if needed.

VIDEO_STORAGE_PATH=/data/uploads/videos
THUMBNAIL_STORAGE_PATH=/data/uploads/thumbnails
TEMP_STORAGE_PATH=/data/uploads/temp
CHUNKS_STORAGE_PATH=/data/uploads/chunks
CATEGORY_IMAGE_STORAGE_PATH=/data/uploads/category-images

# =============================================================================
# UPLOAD LIMITS
# =============================================================================
# Maximum single file size (in bytes)
# Default: 2147483648 = 2GB
MAX_FILE_SIZE_BYTES=2147483648

# Weekly upload quota per user (in bytes)
# Default: 4294967296 = 4GB
WEEKLY_UPLOAD_LIMIT_BYTES=4294967296

# Maximum category image size (in bytes)
# Default: 5242880 = 5MB
MAX_CATEGORY_IMAGE_SIZE_BYTES=5242880

# =============================================================================
# VIDEO SETTINGS
# =============================================================================
# Accepted video formats (comma-separated, no spaces)
ACCEPTED_VIDEO_FORMATS=mp4,mov,avi,mkv,webm

# FFmpeg binary path (usually auto-detected in Docker)
FFMPEG_PATH=/usr/bin/ffmpeg

# Video processing timeout (in seconds)
# Default: 300 = 5 minutes
VIDEO_PROCESSING_TIMEOUT=300

# =============================================================================
# QUOTA RESET SCHEDULE
# =============================================================================
# Day of week to reset quotas (0=Sunday, 6=Saturday)
QUOTA_RESET_DAY=0

# Hour of day to reset quotas (0-23, 24-hour format)
QUOTA_RESET_HOUR=0

# Timezone for quota reset
QUOTA_RESET_TIMEZONE=UTC

# =============================================================================
# INITIAL ADMIN USER
# =============================================================================
# Created automatically on first startup if no admin exists
# IMPORTANT: Change the password immediately after first login!

INITIAL_ADMIN_EMAIL=admin@example.com
INITIAL_ADMIN_USERNAME=admin
INITIAL_ADMIN_PASSWORD=admin123

# =============================================================================
# CORS (Cross-Origin Resource Sharing)
# =============================================================================
# Comma-separated list of allowed origins (no spaces)
# Include: localhost for development, your Cloudflare domain for production
#
# Example with Cloudflare Tunnel:
# BACKEND_CORS_ORIGINS=http://localhost,https://clipset.yourdomain.com

BACKEND_CORS_ORIGINS=http://localhost,http://localhost:5173

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================
# API base URL (used by frontend to communicate with backend)
# Docker: http://localhost/api (goes through nginx reverse proxy)
# Cloudflare: https://clipset.yourdomain.com/api
#
# Note: In Docker, nginx routes /api requests to the backend service

VITE_API_BASE_URL=http://localhost/api

# =============================================================================
# GPU TRANSCODING SETTINGS
# =============================================================================
# Enable NVIDIA GPU acceleration for video transcoding
# Requires: NVIDIA GPU with NVENC support, nvidia-container-toolkit
# Set to false to use CPU transcoding (slower but works without GPU)
USE_GPU_TRANSCODING=false

# GPU device ID (0 for first GPU, 1 for second, etc.)
GPU_DEVICE_ID=0

# NVENC Preset: p1 (fastest) to p7 (slowest/best quality)
# p1 = fastest encoding, lower quality
# p4 = balanced (recommended for RTX 3060 and similar GPUs)
# p7 = slowest encoding, best quality
NVENC_PRESET=p4

# Constant Quality: 18 (best) to 30 (worst quality)
# Lower values = better quality but larger files
# 20 = good default for most content
NVENC_CQ=20

# Rate control mode:
# vbr = variable bitrate (recommended, best quality/size ratio)
# cbr = constant bitrate (streaming)
# constqp = constant quantization parameter
NVENC_RATE_CONTROL=vbr

# Maximum bitrate cap (prevents extremely large files)
# 8M = 8 Mbps (good for 1080p content)
NVENC_MAX_BITRATE=8M

# Buffer size (2x maxrate recommended for VBR smoothness)
NVENC_BUFFER_SIZE=16M
